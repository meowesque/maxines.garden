---
import "../styles/garden-entry.css";
import type { CollectionEntry } from "astro:content";
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import Header from "../components/Header.astro";

type Props = CollectionEntry<"entries">["data"];

function getRelativeTime(date: Date): string {
  const now = new Date();
  const diffInMs = now.getTime() - date.getTime();
  const diffInDays = Math.floor(diffInMs / (1000 * 60 * 60 * 24));
  const diffInMonths = Math.floor(diffInDays / 30);
  const diffInYears = Math.floor(diffInDays / 365);

  if (diffInYears >= 1) {
    return diffInYears === 1 ? "1 year ago" : `${diffInYears} years ago`;
  } else if (diffInMonths >= 1) {
    return diffInMonths === 1 ? "1 month ago" : `${diffInMonths} months ago`;
  } else if (diffInDays >= 1) {
    return diffInDays === 1 ? "1 day ago" : `${diffInDays} days ago`;
  } else {
    return "Today";
  }
}
---

<html lang="en">
  <head>
    <BaseHead title={Astro.props.title} description={Astro.props.description} />
  </head>
  <body>
    <Header />

    <header>
      <div class="header-content">
        <div class="header-top">
          <span class="header-top-designation">GARDEN</span>
          <svg
            version="1.1"
            id="Capa_1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            width="800px"
            height="800px"
            viewBox="0 0 563.732 563.731"
            xml:space="preserve"
          >
            <g>
              <g>
                <path
                  d="M352.791,124.15c0-43.911-27.448-106.815-70.925-124.15c-43.477,17.335-70.925,80.239-70.925,124.15    c0,43.911,27.448,106.812,70.925,124.166C325.342,230.966,352.791,168.064,352.791,124.15z"
                ></path>
                <path
                  d="M316.14,309.326c36.414,29.438,104.723,22.549,143.004,1.047c38.277-21.484,79.679-76.225,73.504-122.615    c-36.396-29.403-104.686-22.549-142.967-1.065C351.404,208.196,309.968,262.921,316.14,309.326z"
                ></path>
                <path
                  d="M459.143,490.711c38.278-21.484,79.68-76.243,73.505-122.63c-36.396-29.403-104.686-22.549-142.967-1.046    c-38.296,21.502-79.716,76.225-73.541,122.632C352.537,519.102,420.848,512.195,459.143,490.711z"
                ></path>
                <path
                  d="M104.606,310.373c38.262,21.502,106.589,28.391,142.966-1.047c6.19-46.387-35.245-101.112-73.504-122.633    c-38.281-21.484-106.589-28.357-142.984,1.065C24.911,234.148,66.347,288.889,104.606,310.373z"
                ></path>
                <path
                  d="M104.606,490.711c38.262,21.487,106.589,28.391,142.966-1.044c6.19-46.39-35.245-101.13-73.504-122.632    c-38.263-21.503-106.589-28.376-142.984,1.046C24.911,414.468,66.328,469.227,104.606,490.711z"
                ></path>
                <path
                  d="M268.098,283.781v270.819c0,5.043,6.163,9.131,13.768,9.131c7.604,0,13.767-4.088,13.767-9.131V283.781    c0-5.043-6.163-9.131-13.767-9.131C274.261,274.65,268.098,278.738,268.098,283.781z"
                ></path>
              </g>
            </g>
            <span class="header-top-stage">SOFTWARE ARCHITECTURE</span>
          </svg>
        </div>
        <div class="header-title">
          {Astro.props.title}
        </div>
        <div class="header-description">
          {Astro.props.description}
        </div>
        <div class="header-bottom">
          <div class="header-tags">
            {
              Astro.props.tags &&
                Astro.props.tags.map((tag: string) => (
                  <a href={`/tags/${tag}`} class="tag-link">
                    {tag}
                  </a>
                ))
            }
          </div>
          <div class="header-dates">
            <span
              >Created about {
                getRelativeTime(new Date(Astro.props.pubDate))
              }</span
            >
            <span>
              {Astro.props.editDate && (
                <>
                  Edited about {
                    getRelativeTime(new Date(Astro.props.editDate))
                  }
                </>
              )}
            </span>
          </div>
        </div>
      </div>
      <div class="header-gradient"></div>
    </header>

    <main>
      <slot />
    </main>
  </body>
</html>
